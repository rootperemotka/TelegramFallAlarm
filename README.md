# Telegram Fall Alarm Bot


# –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
git clone https://git.ccn.rest/peremotka/TelegramFallAlarm.git
cd TelegramFallAlarm
# ...—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º...
git add .
git commit -m "–≤–∞—à –∫–æ–º–º–∏—Ç"
git push
```

## –ï—Å–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ:

```bash
git remote set-url origin https://git.ccn.rest/peremotka/TelegramFallAlarm.git
git push -u origin main
```

---

# –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–Ω–∞–ª–æ–≤ Telegram **–∏–ª–∏** –≤–Ω–µ—à–Ω–µ–≥–æ API (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∂–∏–º)
- ‚è∞ –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- üë• –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üìä –°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- üîî –ï–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∑–≤–æ–Ω–∫–∏ –ø—Ä–∏ —Ç—Ä–µ–≤–æ–≥–µ
- üê≥ –ó–∞–ø—É—Å–∫ –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- üìû –ì–æ–ª–æ—Å–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å –ó–≤–æ–Ω–æ–±–æ—Ç
- üö® –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–≤–æ–Ω–∫–∏ –ø—Ä–∏ —Ç—Ä–µ–≤–æ–≥–µ

---

# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç—Ä–µ–≤–æ–≥–∞?

- –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ —Ç—Ä–µ–≤–æ–≥–∏ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API) **—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –∑–≤–æ–Ω–æ–∫ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**.
- –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è (API —Å–Ω–æ–≤–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ), —Å—á–µ—Ç—á–∏–∫ —Ç—Ä–µ–≤–æ–≥–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è.
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∑–≤–æ–Ω–∫–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –ø–æ–∫–∞ —Ç—Ä–µ–≤–æ–≥–∞ –Ω–µ —Å–±—Ä–æ—à–µ–Ω–∞.

---

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker
- Docker Compose

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://git.ccn.rest/peremotka/TelegramFallAlarm.git
cd TelegramFallAlarm
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ `.env` (–æ—Å–æ–±–µ–Ω–Ω–æ TELEGRAM_BOT_TOKEN)
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é Docker Compose:

```bash
docker-compose up -d
```

–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤:

```bash
docker-compose logs -f
```

–î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏:

```bash
docker-compose down
```

---

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–§–∞–π–ª `.env` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º TELEGRAM_BOT_TOKEN). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```env
# Telegram Bot Settings
TELEGRAM_BOT_TOKEN=your_bot_token
TELEGRAM_HANDLERS_PATH=components/handlers
TELEGRAM_BOT_USERS_ID_ACCESS=all  # –∏–ª–∏ —Å–ø–∏—Å–æ–∫ ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é

# Alarm Settings
ALARM_MONITOR_MODE=api            # —Ä–µ–∂–∏–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞: 'api' –∏–ª–∏ 'channel'
ALARM_MONITOR_CHANNEL_ID=auto     # –∏–ª–∏ ID –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ (–¥–ª—è —Ä–µ–∂–∏–º–∞ channel)
ALARM_TIMEOUT_FOR_MESSAGE=300     # —Ç–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
ALARM_MESSAGE_AUTHOR_ID=all       # –∏–ª–∏ ID –∞–≤—Ç–æ—Ä–∞
ALARM_USERS_ID_NOTIFICATION=all   # –∏–ª–∏ —Å–ø–∏—Å–æ–∫ ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
ALARM_MONITOR_TIMEOUT=60          # –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
ALARM_PHONES_FOR_CALL=79XXXXXXXXX,79XXXXXXXXX  # —Å–ø–∏—Å–æ–∫ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –¥–ª—è –∑–≤–æ–Ω–∫–æ–≤

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API (–¥–ª—è —Ä–µ–∂–∏–º–∞ 'api')
ALARM_API_URL=http://example.com/alive
ALARM_API_METHOD=GET
ALARM_API_HEADERS=key:value
ALARM_API_BODY=

# Zvonobot Settings
ZVONOBOT_API_KEY=your_api_key     # API-–∫–ª—é—á –æ—Ç —Å–µ—Ä–≤–∏—Å–∞ –ó–≤–æ–Ω–æ–±–æ—Ç
ZVONOBOT_OUTGOING_PHONE=79XXXXXXXXX # –ù–æ–º–µ—Ä –¥–ª—è –∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–≤–æ–Ω–∫–æ–≤
ZVONOBOT_DUTY_PHONE=0             # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∂—É—Ä–Ω—ã–π –Ω–æ–º–µ—Ä (0 - –Ω–µ—Ç, 1 - –¥–∞)
ZVONOBOT_VOICE_GENDER=0           # –ü–æ–ª –≥–æ–ª–æ—Å–∞ (0 - –∂–µ–Ω—Å–∫–∏–π, 1 - –º—É–∂—Å–∫–æ–π)
ZVONOBOT_MESSAGE=                 # –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Ç—Ä–µ–≤–æ–≥–µ (–µ—Å–ª–∏ –ø—É—Å—Ç–æ, –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

---

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å –ø–æ–º–æ—â—å—é Docker
2. –í Telegram:
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/start_monitoring` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/status` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/stop_monitoring` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

---

# –ö–æ–º–∞–Ω–¥—ã

- `/start` - –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥–∞—Ö
- `/start_monitoring` - –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (API –∏–ª–∏ –∫–∞–Ω–∞–ª–æ–≤, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞)
- `/stop_monitoring` - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- `/status` - –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
TelegramFallAlarm/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __example.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_monitor.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ channel_monitor.py
‚îÇ   ‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ modules/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ applogger.py
‚îÇ       ‚îú‚îÄ‚îÄ envreader.py
‚îÇ       ‚îî‚îÄ‚îÄ zvonobot.py
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env
‚îî‚îÄ‚îÄ README.md
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `components/handlers/`
2. –£–Ω–∞—Å–ª–µ–¥—É–π—Ç–µ –∫–ª–∞—Å—Å –æ—Ç `BaseRouter`
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
4. –†–æ—É—Ç–µ—Ä –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ (–∫—Ä–æ–º–µ `api_monitor` –∏ `channel_monitor`, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º—É)

---

# –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
